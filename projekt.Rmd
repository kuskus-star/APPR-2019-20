---
title: "Poročilo pri predmetu Ana Liza podatkov s programom R"
subtitle: "Analiza neudeležbe na kulturnih prireditvah v Sloveniji"
author: "Filip Škrlj"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding="UTF-8")

# Uvoz vseh potrebnih ;) knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, echo=FALSE, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

# Izbira teme

Tema: Analiza neudeležbe na kulturnih prireditvah v Sloveniji

V projektni nalogi bom analiziral neudeleževanje v kulturnih in športnih aktivnostih in razloge za te v letu 2015. Zanima me, kako se spreminja kulturno in športno udeleževanje  pri posameznikih,glede na prihodni kvantil, vrsto gospodinjstva, in stopnjo urbanizacije.


***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Vhodni podatki so v obliki.csv 

Vir podatkov:https://appsso.eurostat.ec.europa.eu/nui/submitViewTableAction.do

Podatki so v 2 tabelah:

Tabela 1:  - 'neudelezevanje':
 - 'TIME' - (število)
 - 'GEO' -(neurejen faktor)
 - 'FREQUENC'- (neurejen faktor)
 - 'DEG_URB' -(neurejen faktor)
 - 'QUANITLE' -(neurejen faktor)
 - 'UNIT' -(neurejen faktor)
 - 'VALUE' -(število)
 - 'Flags and foot's notes' -(neurejen faktor)

Tabela 2: Namen uporabe interneta po izobrazbi in spolu - 'izobrazba_in_spol':
 
 - 'ACL00' -(neurejen faktor)
 - 'GEO' -(neurejen faktor)
 - 'TIME' - (število)
 - 'QUANITLE' -(neurejen faktor)
 - 'DEG_URB' -(neurejen faktor)
 - 'FREQUENC'- (neurejen faktor)
 -'TIME' -(številka) 
 - UNIT' -(neurejen faktor)
 - VALUE' -(število)
 - Flags and foot's notes' -(neurejen faktor)




# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```



```{r vizualizacija, echo=FALSE, fig.align='center', fig.cap='Zemljevid povprečnega števila otrok v družini'}
raz1slo
```
Zgornji stolpični graf prikazujedelež populacije v sloveniji ki ne hodi v kino po kvintilih(x-os) in navedenih ralogih.Kot po pričakovanjih so finančni razogi razlog ki je najbolj odvisen od finančnega statusa, količina ljudi ki pa jih od kina odvračata ne zanimanje ali prekomerna razdaljapa pa se zdi na prvi pogled konsistenta zato ločimo graf po razlogih
```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
fin1slo
non1slo
```
Razvidno je torej da Hoja v kino vsaj linearno pada z nižanjem finančne sposognosti, Neobiskovanje zaradi odaljenosti pa izgleda malo bol komplicirano saj na na neki stopnji revščine,najvrjetneje zaradi koncetracije revščine v mestih, z dostop do kina začne povečevati. 
```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
Graf_romunija
Graf_spanija
```

S tem povodom primerjam Neudeležbo v kinih(kjer je naveden razlog da kina ni v okolici) v dveh državah,
Španiji in Romunij. V romuniji vidimo da z revšino narašča tudi dobesedni dostop do kin, za španijo se pa ta navidezno linearna rast pri prvem kvintilu nenadoma obrne.
# Napredna analiza podatkov

```{r analiza, echo=FALSE, message=FALSE}
source("analiza/analiza.r", encoding="UTF-8")
```

Spodnji graf prikazuje povezavo med številom naselij in površino občine.

```{r graf, echo=FALSE, fig.align='center', fig.cap='Povezava med številom naselij in površino občine'}
ggplot(inner_join(obcine, data.frame(obcina=names(skupine),
                                     skupina=factor(skupine)), by="obcina")
, aes(x=povrsina, y=naselja, color=skupina, size=prebivalci/1000)) + geom_point() +
  ggtitle("Število naselij glede na površino občine") +
  xlab(expression("Površina (km"^2 * ")")) + ylab("Št. naselij") +
  guides(color=guide_legend(title="Skupina"),
         size=guide_legend(title="Prebivalci (* 1000)"))
```

***

```{r shiny, echo=FALSE}
shinyAppDir("shiny", options=list(width="100%", height=600))
```
